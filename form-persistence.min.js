const FormPersistence=(()=>{function e(e){let t={},o=new FormData(e),l=function(e){let t=`form#${e.id} input[type="password"],input[type="password"][form="${e.id}"]`,o=document.querySelectorAll(t);return Array.from(o).map(e=>e.name)}(e);for(let e of o.keys())if(!l.includes(e)){let l=o.getAll(e).filter(e=>"File"!==e.constructor.name);0<l.length&&(t[e]=l)}return t}function t(t,o=!1){let l=e(t);(o?sessionStorage:localStorage).setItem(c(t),JSON.stringify(l))}function o(e,t,o){let l=[];void 0!==o&&(l=function(e,t,o){let l=[];for(let n in o)if(n in e){for(let l of e[n])o[n](t,l);l.push(n)}return l}(t,e,o));let n=[];for(let o in t)if(!l.includes(o)){r(e.id,o).forEach((e,l)=>{i(e,t[o],l,n)})}!function(e,t){let o=e.querySelectorAll('input[type="checkbox"]');for(let e of o)!t.includes(e)&&e.checked&&e.click()}(e,n)}function l(e,t=!1,l){let n=(t?sessionStorage:localStorage).getItem(c(e));if(n){o(e,JSON.parse(n),l)}}function n(e,t=!1){let o=t?sessionStorage:localStorage;o.removeItem(c(e)),console.log("cleared");let l=o.getItem(c(e));console.log(l)}function r(e,t){let o=o=>`form#${e} ${o}[name="${t}"]`,l=o=>`${o}[name="${t}"][form="${e}"]`,n=[o("input"),o("textarea"),o("select"),l("input"),l("textarea"),l("select")];return document.querySelectorAll(n.join())}function i(e,t,o,l){let n=e.tagName;if("INPUT"===n){let n=e.type;"radio"===n?e.value===t[0]&&!e.checked&&e.click():"checkbox"===n?t.includes(e.value)&&(!e.checked&&e.click(),l.push(e)):e.value=t[o]}else if("TEXTAREA"===n)e.value=t[o];else if("SELECT"===n)if(e.multiple)for(let o of e.options)o.selected=t.includes(o.value);else e.value=t[o]}function c(e){return"form#"+e.id}return{persist:function(e,o=!1,r=!1,i){l(e,o,i);let c=()=>t(e,o);window.addEventListener("beforeunload",c),r||e.addEventListener("submit",()=>{window.removeEventListener("beforeunload",c),n(e,o)})},load:l,save:t,clearStorage:n,serialize:e,deserialize:o}})();